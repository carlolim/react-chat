(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(e,t,a){},27:function(e,t,a){e.exports=a(58)},33:function(e,t,a){},56:function(e,t,a){},58:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),r=a(23),o=a.n(r),i=(a(20),a(3)),c=a(8),l=a(9),u=a(11),m=a(10),d=a(12),f=(a(33),a(13)),g=a.n(f),h=a(14),p=a.n(h);g.a.initializeApp({apiKey:"AIzaSyAurCWIRGX8SCaNGIyfThNKkvr8FrJScn8",authDomain:"react-firebase-e48ce.firebaseapp.com",databaseURL:"https://react-firebase-e48ce.firebaseio.com",projectId:"react-firebase-e48ce",storageBucket:"",messagingSenderId:"724913728461"});var v=g.a.database(),b=function(e){v.ref("/messages").push(e)},w=v,y=a(6),E=a(18),j=a(7),O=a(26),N="get all messages append sa store",k="append new message from firebase to store",S="append new user to store",x="get all users",I=function(e){return{type:k,payload:e}},C=function(e){return{type:S,payload:e}};var M={users:[],messages:[]};var W=Object(j.c)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return Object(i.a)({},e,{messages:t.payload});case k:return Object(i.a)({},e,{messages:[].concat(Object(E.a)(e.messages),[t.payload])});case S:return Object(i.a)({},e,{users:[].concat(Object(E.a)(e.users),[t.payload.name])});case x:return Object(i.a)({},e,{users:t.payload});default:return e}},Object(j.a)(O.a)),A=(a(56),function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{style:{maxWidth:"500px",margin:"0 auto",marginTop:"100px"}},s.a.createElement("section",{className:"form container with-title"},s.a.createElement("h2",{className:"title"},"Register"),s.a.createElement("div",{className:"field"},s.a.createElement("label",{htmlFor:"name_field"},"Welcome adventurer! Please input your name."),s.a.createElement("form",{onSubmit:function(e){e.preventDefault(),function(e){if(""!==e&&null!==e&&void 0!==e){var t=p()();v.ref("/users").push({name:e,id:t},function(a){if(a)console.log("Registration error: ",a);else{var n={id:t,name:e};localStorage.setItem("user",JSON.stringify(n)),b({content:e+" joined the chat.",userId:"1",user:{id:"1",name:"[system]"}}),window.location.reload()}})}}(e.target.name.value)}},s.a.createElement("input",{autoComplete:"off",id:"name_field",type:"text",name:"name",className:"input input-fix"}),s.a.createElement("br",null),s.a.createElement("button",{className:"btn"},"Submit")))))}}]),t}(n.Component)),J=Object(y.b)(function(e){return{state:e}},function(e){return{}})(A),R=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={message:""},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"handleMessageChange",value:function(e){this.setState(Object(i.a)({},this.state,{message:e.target.value}))}},{key:"handleAddMessage",value:function(){if(this.hasUser()){if(""!==this.state.message){var e=JSON.parse(localStorage.getItem("user"));b({userId:e.id,content:this.state.message,user:e}),this.setState(Object(i.a)({},this.state,{message:""}))}}else window.location.reload()}},{key:"hasUser",value:function(){return null!==localStorage.getItem("user")}},{key:"isMe",value:function(e){return JSON.parse(localStorage.getItem("user")).id===e}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{style:{maxWidth:"600px",margin:"0 auto",marginTop:"100px"}},this.hasUser()?s.a.createElement("div",null,s.a.createElement("section",{id:"messages-window",className:"balloon container with-title",style:{maxHeight:"600px",overflowY:"scroll"}},s.a.createElement("div",{className:"messages"},this.props.state.messages.map(function(t,a){return s.a.createElement("div",{className:"text-".concat(e.isMe(t.userId)?"right":"left"),key:a},s.a.createElement("div",{className:"balloon from-".concat(e.isMe(t.userId)?"right":"left")},s.a.createElement("p",null,t.content)),s.a.createElement("i",{className:"message-sender text-".concat(e.isMe(t.userId)?"right":"left")},t.user.name))}))),s.a.createElement("br",null),s.a.createElement("section",{className:"form container with-title"},s.a.createElement("h2",{className:"title"},"Message"),s.a.createElement("div",{className:"field"},s.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.handleAddMessage()}},s.a.createElement("input",{autoComplete:"off",value:this.state.message,onChange:this.handleMessageChange.bind(this),id:"name_field",type:"text",name:"name",className:"input input-fix"}),s.a.createElement("button",{className:"btn"},"Send"))))):s.a.createElement(J,null))}}]),t}(n.Component),T=Object(y.b)(function(e){return{state:e}},function(e){return function(e){w.ref("/messages").on("child_added",function(t){e(I(t.val()))})}(e),function(e){w.ref("/users").on("child_added",function(t){e(C(t.val()))})}(e),{}})(R),U=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function _(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(s.a.createElement(y.a,{store:W},s.a.createElement(T,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/react-chat",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/react-chat","/service-worker.js");U?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):_(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):_(e)})}}()}},[[27,2,1]]]);
//# sourceMappingURL=main.8369fb1a.chunk.js.map